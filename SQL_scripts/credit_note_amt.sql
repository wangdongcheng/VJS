USE VJSCL
SELECT 
OH_ACCOUNT AS CustomerCode, 
CUNAME AS CustName, 
OH_WORK_STATUS AS Reason,
 
-- Q1: January to March
COUNT(CASE 
WHEN OH_DATE BETWEEN '2025-01-01' AND '2025-03-31' 
THEN 1 
END) AS QTR1_2025_CreditNotes,
 
SUM(CASE 
WHEN OH_DATE BETWEEN '2025-01-01' AND '2025-03-31' 
THEN OH_NETT * -1 
END) AS QTR1_2025_TotalValue,
 
-- Q2: April to June
COUNT(CASE 
WHEN OH_DATE BETWEEN '2025-04-01' AND '2025-06-30' 
THEN 1 
END) AS QTR2_2025_CreditNotes,
 
SUM(CASE 
WHEN OH_DATE BETWEEN '2025-04-01' AND '2025-06-30' 
THEN OH_NETT * -1 
END) AS QTR2_2025_TotalValue
 
FROM 
ORD_HEADER oh
INNER JOIN 
SL_ACCOUNTS A ON OH.OH_ACCOUNT = A.CUCODE
WHERE 
OH_TYPE = 'C'
AND OH_DATE BETWEEN '2025-01-01' AND '2025-06-30'
GROUP BY 
OH_ACCOUNT, CUNAME, OH_WORK_STATUS